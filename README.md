# Установка

# Зависимости

 - docker >= 18.06
 - docker-compose >= 1.22
 - python 2.7
 - [rsa ключ для доступа к шифрованным данным](./docs/gpg.md)
 - доступ к серверу с резервными копиями

## Локальное окружение

1. Не фиксируем права доступа
    ```bash
    git config core.fileMode false
    ```

2. Делаем скрипты исполняемыми

    ```
    sudo chmod +x ./etc/scripts/*
    ```

3. Запускаем сборку
    ```bash
    ./etc/scripts/init_local -r -f
    ```
    
    Для просмотра обозначений ключей используем `--help`

4. Сайт будет доступен по адресу `http://127.0.0.1:8011`

    Рекомендуется добавить правила проксирования с локального домена `politsturm.local` 
    на вышеуказанный порт т.к. данный домен прописан в переменных окружения и 
    используется как `WP_SITEURL` и `WP_HOME`

### Шифрованные данные
Для каждого окружения есть шифрованный файл в котором хранятся секретные данные.

 - local -> `./etc/env/.env.local.gpg`
 - production -> `./etc/env/.env.production.gpg`

Детали по работе с ними [тут](./docs/gpg.md) 

### Изображение
Для локального окружения запрос к изображениям проксируется на сайт `politsturm.com`. 
